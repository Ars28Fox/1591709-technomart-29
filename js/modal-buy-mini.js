const buyLink=document.querySelectorAll(".product-item__actions-button-buy"),buyPopup=document.querySelector(".modal-buy"),buyClose=buyPopup.querySelector(".modal__close"),buyCloseShopLink=buyPopup.querySelector(".modal-buy__shop-link"),orderLink=buyPopup.querySelector(".modal-buy__order-link"),focusableElements='button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])',firstFocusableElement=buyPopup.querySelectorAll(focusableElements)[0],focusableContent=buyPopup.querySelectorAll(focusableElements),lastFocusableElement=focusableContent[focusableContent.length-1];let currentBuyLink=null;buyLink.forEach(function(e){e.addEventListener("click",function(t){t.preventDefault(),currentBuyLink=e,buyPopup.classList.add("modal--active"),orderLink.focus()})}),buyClose.addEventListener("click",function(e){e.preventDefault(),buyPopup.classList.remove("modal--active"),currentBuyLink.closest(".product-item").focus(),currentBuyLink.focus()}),buyCloseShopLink.addEventListener("click",function(e){e.preventDefault(),buyPopup.classList.remove("modal--active"),currentBuyLink.closest(".product-item").focus(),currentBuyLink.focus()}),window.addEventListener("keydown",function(e){27===e.keyCode&&buyPopup.classList.contains("modal--active")&&(e.preventDefault(),buyPopup.classList.remove("modal--active"),currentBuyLink.closest(".product-item").focus(),currentBuyLink.focus())}),window.addEventListener("keydown",function(e){("Tab"===e.key||9===e.keyCode)&&(e.shiftKey?document.activeElement===firstFocusableElement&&(lastFocusableElement.focus(),e.preventDefault()):document.activeElement===lastFocusableElement&&(firstFocusableElement.focus(),e.preventDefault()))}),firstFocusableElement.focus();
