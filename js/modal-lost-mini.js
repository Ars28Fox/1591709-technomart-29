const lostLink=document.querySelector(".contacts__lost-link"),lostPopup=document.querySelector(".modal-lost"),lostClose=lostPopup.querySelector(".modal__close"),lostName=document.getElementById("fullname-field"),lostForm=lostPopup.querySelector(".modal-lost__form"),lostEmail=document.getElementById("email-field"),lostMessage=lostPopup.querySelector(".modal-lost__field-textarea"),focusableElementsLost='button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])',firstFocusableElementLost=lostPopup.querySelectorAll(focusableElementsLost)[0],focusableContentLost=lostPopup.querySelectorAll(focusableElementsLost),lastFocusableElementLost=focusableContentLost[focusableContentLost.length-1];let isStorageSupport=!0,fullname="",email="";try{fullname=localStorage.getItem("fullname"),email=localStorage.getItem("email"),fullname&&(lostName.value=fullname),email&&(lostEmail.value=email)}catch(e){isStorageSupport=!1}lostLink.addEventListener("click",function(e){e.preventDefault(),lostPopup.classList.add("modal--active"),fullname&&!email&&lostEmail.focus(),email&&!fullname&&lostName.focus(),email&&fullname&&lostMessage.focus()}),lostClose.addEventListener("click",function(e){e.preventDefault(),lostPopup.classList.remove("modal--active"),lostPopup.classList.remove("modal--error"),lostLink.focus()}),lostForm.addEventListener("submit",function(e){lostName.value&&lostEmail.value&&lostMessage.value?isStorageSupport&&(localStorage.setItem("fullname",lostName.value),localStorage.setItem("email",lostEmail.value)):(e.preventDefault(),lostPopup.classList.remove("modal--error"),lostPopup.offsetWidth=lostPopup.offsetWidth,lostPopup.classList.add("modal--error"))}),window.addEventListener("keydown",function(e){27===e.keyCode&&lostPopup.classList.contains("modal--active")&&(e.preventDefault(),lostPopup.classList.remove("modal--active"),lostPopup.classList.remove("modal--error"),lostLink.focus())}),document.addEventListener("keydown",function(e){("Tab"===e.key||9===e.keyCode)&&(e.shiftKey?document.activeElement===firstFocusableElementLost&&(lastFocusableElementLost.focus(),e.preventDefault()):document.activeElement===lastFocusableElementLost&&(firstFocusableElementLost.focus(),e.preventDefault()))}),firstFocusableElementLost.focus();
